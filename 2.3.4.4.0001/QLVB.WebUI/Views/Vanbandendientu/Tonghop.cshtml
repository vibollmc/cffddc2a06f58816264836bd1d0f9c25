@{
	DateTime strngaybd = DateTime.Now;
	DateTime strngaykt = strngaybd.AddDays(10);

    var Email = new[]{
				new {value = "0", name = "Địa chỉ mail"},
				new {value = "1", name = "Tên đơn vị"}
			};	
}

@section header{
	<i class="glyphicon glyphicon-info-sign">&nbsp;</i>Tổng hợp Văn bản đến điện tử
}

<div class="box ">
	<header>
		<nav class="box-toolbar">
			<button id="Thongkebtn" type="button" class="btn btn-sm btn-primary btn-flat" title="Tổng hợp">
				<i class="glyphicon glyphicon-refresh"></i>&nbsp;Thống kê
			</button>
			<button id="Backbtn" type="button" class="btn btn-sm btn-primary btn-flat " data-original-title="" title="">
				<i class="glyphicon glyphicon-arrow-left"></i>&nbsp;Quay lại
			</button>
		</nav>
	</header>
	<div id="div-1" class="body">
        <form class="form-horizontal" id="formMail">
            <div class="form-group">
                <div class="col-xs-3">
                    @Html.CheckBox("chkNgayky", true, new { disabled = "disable" })
                    @Html.Label("Ngày ký", new { @class = "control-label " })
                </div>
                <div class="col-sx-8">
                    @(Html.Kendo().DatePicker()
                        .Name("strngaykybd")
                        .Value(strngaybd)
                        .Format("dd/MM/yyyy")
                    )
                    &nbsp;&nbsp;==>&nbsp;&nbsp;
                    @(Html.Kendo().DatePicker()
                        .Name("strngaykykt")
                        .Value(strngaykt)
                        .Format("dd/MM/yyyy")
                    )

                </div>
            </div>
            <div class="form-group">
                <div class="col-xs-3">
                    @Html.Label("Tổng hợp theo ", new { @class = "control-label " })
                </div>
                <div class="col-xs-3">
                    @(Html.Kendo().DropDownList()
                            .Name("LoaiTonghop")
                            .BindTo(Email)
                            .DataTextField("name")
                            .DataValueField("value")
                            .Value("0")
                            .HtmlAttributes(new { @style = "width:100%;" })
                    )
                </div>
            </div>
            <div class="form-group">
                <div class="col-xs-3">
                    @Html.CheckBox("chkNgaygui", true)
                    @Html.Label("Ngày gửi lớn hơn ngày ký", new { @class = "control-label " })
                </div>
                <div class="col-xs-3">
                    @Html.TextBox("intSoNgaygui", 3, new { @class = "form-control ", placeholder = "Số ngày" })
                </div>

            </div>
            <div class="form-group">
                <div class="col-xs-3">
                    @Html.CheckBox("chkDanhmuc", true)
                    @Html.Label("Sử dụng Danh mục Cấp cơ quan", new { @class = "control-label " })
                </div>        
            </div>
            
        </form>
	</div>
</div>
<div id="TonghopVBDenDT"></div>
<script type="text/javascript">
	$('#Thongkebtn').click(function () {
		var url = '@Url.Action("_TonghopVBDT","Vanbandendientu")';

		var isngayky = $('#chkNgayky').is(':checked');
		if (isngayky == true) {
			var strngaykybd = $('#strngaykybd').val();
			var strngaykykt = $('#strngaykykt').val();
			url = url + '?strngaykybd=' + strngaykybd + '&strngaykykt=' + strngaykykt;
		}
		var isngaygui = $('#chkNgaygui').is(':checked');
		if (isngaygui == true) {		
		    var songaygui = $('#intSoNgaygui').val();			
		    url = url + '&intSoNgaygui=' + songaygui;
		}
		var isDanhmuc = $('#chkDanhmuc').is(':checked');
		if (isDanhmuc == true) {
			url = url + "&danhmuc=true";
		}
		var LoaiTonghop = $('#LoaiTonghop').val();
		url = url + "&LoaiTonghop=" + LoaiTonghop;
        
		ShowLoading();		
		$('#TonghopVBDenDT').load(url);
	});
	$('#Backbtn').click(function () {
		var url = '@Url.Action("Index", "Vanbandendientu")';
		window.location = url;
	})
    function OpenDetail(stremail,strtendonvi) {
        var url = '@Url.Action("TonghopDonvi", "Vanbandendientu")';

        var strngaykybd = $('#strngaykybd').val();
        var strngaykykt = $('#strngaykykt').val();

        var LoaiTonghop = $('#LoaiTonghop').val();
        url = url + '?LoaiTonghop=' + LoaiTonghop;

        switch (LoaiTonghop) {
            case '0':
                url = url + '&stremail=' + stremail;
                break;
            case '1':
                url = url + '&stremail=' + strtendonvi;
                break;
            default:
                break;
        }
        
        url = url + '&strngaykybd=' + strngaykybd + '&strngaykykt=' + strngaykykt;

        var isngaygui = $('#chkNgaygui').is(':checked');
        if (isngaygui == true) {
            var songaygui = $('#intSoNgaygui').val();
            url = url + '&intSoNgaygui=' + songaygui;
        }
        var isDanhmuc = $('#chkDanhmuc').is(':checked');
        if (isDanhmuc == true) {
            url = url + "&danhmuc=true";
        }
        
        $().redirect(url);
    }
</script>
